<UserControl x:Class="Aurora.Controls.Control_GameStateParameterPicker"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Aurora.Controls"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             mc:Ignorable="d" Height="22">

    <UserControl.Resources>
        <DataTemplate x:Key="ListItemTemplate">
            <TextBlock Text="{Binding .}" Padding="4,1" />
        </DataTemplate>
        <local:IsStringNotNullOrWhitespaceConverter x:Key="IsStringNotNullConv" />
        <local:PropertyTypeToGridLengthConverter x:Key="PropTypeToHeightConv" />
    </UserControl.Resources>

    <Grid>
        <!-- Main visible button -->
        <ToggleButton x:Name="pickerButton" Click="PickerButton_Click" HorizontalContentAlignment="Left" Padding="4,1" IsChecked="{Binding IsOpen, Mode=TwoWay}" Content="{Binding SelectedPath}" Style="{StaticResource DropDownToggleButton}" />

        <!-- Content that appears on click -->
        <Popup Name="pickerPopup" StaysOpen="False" IsOpen="{Binding IsOpen, Mode=TwoWay}" PopupAnimation="Slide">
            <Grid x:Name="popupContent" Background="{StaticResource BaseBackgroundBrush}" Height="280" Width="100">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="1*" />
                    <RowDefinition Height="{Binding PropertyType, Converter={StaticResource PropTypeToHeightConv}}" />
                </Grid.RowDefinitions>

                <!-- Up button and current "directory" -->
                <StackPanel Grid.Row="0" Orientation="Vertical">
                    <Button Content="⬅ Previous" IsEnabled="{Binding WorkingPathStr, Converter={StaticResource IsStringNotNullConv}}" Margin="6" Padding="6,2" Click="BackBtn_Click" />
                    <TextBlock Text="{Binding WorkingPathStr}" Margin="6,0,6,6" VerticalAlignment="Center" />
                </StackPanel>

                <!-- List boxes (aux is for animation) -->
                <ListBox x:Name="mainListBox" Grid.Row="1" ItemsSource="{Binding MainParameterListItems}" ItemTemplate="{StaticResource ListItemTemplate}" Background="#181818" HorizontalAlignment="Left" PreviewMouseLeftButtonDown="MainListBox_PreviewMouseLeftButtonDown" />
                <ListBox x:Name="auxillaryListbox" Grid.Row="1" ItemTemplate="{StaticResource ListItemTemplate}" Background="#181818" HorizontalAlignment="Left" />

                <!-- Numeric input for numeric types -->
                <DockPanel Grid.Row="2" LastChildFill="True">
                    <TextBlock Text="Or enter number:" VerticalAlignment="Center" Margin="6,4,0,6" DockPanel.Dock="Left" />
                    <xctk:DoubleUpDown x:Name="numericEntry" Margin="6" ValueChanged="NumericEntry_ValueChanged" />
                </DockPanel>

                <!-- Border around all popup content -->
                <Border BorderBrush="#454545" BorderThickness="1" Grid.RowSpan="999" />
            </Grid>
        </Popup>
    </Grid>
</UserControl>
